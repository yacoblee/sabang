<?xml version="1.0" encoding="UTF-8"?><!-- 
   수정일                 수정자            수정내용
  =========     =======    =================================================
  2011.08.26   	서준식     	   SSO 로그인을 위한 쿼리 추가
  2011.09.27    서준식            컬럼 변경 SUB_DN 을  CRTFC_DN_VALUE 로 변경
  2011.09.28    서준식            컬럼 변경 entrprsmber_id 을  ENTRPRS_MBER_ID 로 변경
  2020.07.06    신용호            비밀번호 만료여부 조회
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapServiceDAO">

    <!-- 
    @author ipodo
    @name selectApiClsfyList
    @param
    @returns {EgovMap} egovMap - list egovMap
    @description API 서비스 분류 목록 조회
     -->
    <select id="selectApiClsfyList" resultType="egovMap">
        SELECT DISTINCT CLSFY_NM
		FROM TN_FEIS_API_LIST TFAL
		WHERE 1 = 1 AND ETC = 'Y' AND ORG_NM = '공간정보오픈플랫폼'
		ORDER BY CLSFY_NM
    </select>
    
    <!-- 
    @author ipodo
    @name selectApiServiceList
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description API 서비스 상세 목록 조회
     -->
    <select id="selectApiServiceList" resultType="egovMap" parameterType="hashMap">
        SELECT DISTINCT SERVICE_NM, URI 
		FROM TN_FEIS_API_LIST TFAL
		WHERE 1 = 1 AND ETC = 'Y' AND ORG_NM = '공간정보오픈플랫폼'
		<if test="clsfy_nm != null">
		AND CLSFY_NM = #{clsfy_nm}
		</if>
		ORDER BY SERVICE_NM
    </select>
    
    <select id="selectFeatureInfo" resultType="String" parameterType="hashMap">
    	SELECT ROW_TO_JSON(f)::JSON AS FEATURE
		 FROM
		 (
		 	SELECT 
		 		'Feature' AS TYPE
		 		, ST_ASGEOJSON(ST_TRANSFORM(ST_TRANSFORM(A.SMGEOMETRY, 4326), 5186) )::JSON AS GEOMETRY
		 		, TO_JSONB(B.*) - 'lcmap' - 'geometry' - 'dmgsttus' - 'dmgfclt' - 'trglnd' - 'sttusprnt' AS PROPERTIES
<!-- 		 		, B.LCMAP::JSON AS DATA -->
		 	FROM 
		 	<if test="type eq 'BSC'">
		 	TF_FEIS_BSC_SVYCOMPT AS A, TN_FEIS_BSC_SVYMEMO AS B, TN_FEIS_BSC_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'APR'">
		 	TF_FEIS_FCK_APRCOMPT AS A, TN_FEIS_FCK_APRMEMO AS B, TN_FEIS_APR_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'LCP'">
		 	TF_FEIS_LCP_SVYCOMPT AS A, TN_FEIS_LCP_SVYMEMO AS B, TN_FEIS_LCP_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'WKA'">
		 	TF_FEIS_WKA_SVYCOMPT AS A, 
		 	(
		 	SELECT C.GID,C.SD,C.SGG,C.EMD,C.RI,C.JIBUN,C.SVYUSER,C.SVYDT,C.DGRAREA,C.FRGLTYRENAREA,C.SAFEFCT,C.HOUSE,C.LAKE,C.HIGHMAINFCT,C.HIGHHOUSESTTUS,C.LOWMAINFCT,C.LOWHOUSESTTUS
		 	,C.NCSSTYWORKTYPE,C.ELEVATION,C.FIELDSURVEYSCORE,C.STABANALSCORE,C.SCORESUM,C.JDGMNTGRAD,C.MNGNCSSTY,C.STDSAFEFACTOR,C.DRYSEASON,C.RAINSEASON,C.PLACELEN,C.SEPDIST,C.DEBFSETR
		 	,C.ALTRV,E.DIRSTTUS,E.PRNTROCK,E.SOILCHAR,E.SLOPELEN,E.SLOPE,E.SLOPEMIN,E.SLOPEMAX,E.RIDGE,E.SLOPELC,E.PNTMAX,E.PNTMIN,E.DIRFRM,E.SOILDEP,E.CRCK,E.SINK,E.UPLIFT,E.EXTDISTALEND
		 	,E.EXPANDPREDIC,E.USWTRORDTMAT,E.RAINFALLWATER,E.DIRWET,E.DIRDRY,E.SCODSLTN,E.MNTNTRNTMIN,E.MNTNTRNTMAX,E.MNTNTRNTAVG,E.MNTNTRNTLEN,E.IFTNPNTLEN,E.IFTNPNTEVTN,E.EPNTPARTCLR
		 	,E.SPNTPARTCLR,E.OVRFLWSTTUS,E.MNTNTRNTSITTN,E.MDGFWSTTUS,E.MNTNTRNTCNT,E.LWDLEN,E.SDTYTOPO,E.LSLMPLND,E.RSLMPLND,E.FRTP,E.STDDNST,E.STDDMCLS,C.SVYTYPE,C.SVYID
		 	FROM TN_FEIS_WKA_SVYMEMO01 C, TN_FEIS_WKA_SVYMEMO03 E
		 	WHERE C.GID = E.GID
		 	AND C.GID = #{gid}
		 	) AS B, TN_FEIS_WKA_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'CNL'">
		 	TF_FEIS_CNL_SVYCOMPT AS A, TN_FEIS_CNL_SVYMEMO AS B,, TN_FEIS_CNL_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'FRD'">
		 	TF_FEIS_FRD_SVYCOMPT AS A, TN_FEIS_FRD_SVYMEMO AS B, TN_FEIS_FRD_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'MSE'">
		 	TF_FEIS_MSE_SVYCOMPT AS A, TN_FEIS_MSE_SVYMEMO AS B, TN_FEIS_MSE_CNRSSPCE C
		 	</if>
		 	<if test="type eq 'PCS'">
		 	TF_FEIS_PCS_SVYCOMPT AS A, TN_FEIS_PCS_SVYMEMO AS B, TN_FEIS_MSE_CNRSSPCE C
		 	</if>
		 	WHERE A.GID = B.GID
		 	AND A.GID = #{gid}
		 	AND A.MST_ID = C.ID
		 	AND A.SMGEOMETRY IS NOT NULL
		 ) AS f
    </select>
    
    <!-- 
    @author ipodo
    @name selectBscSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer}
    @description 기초조사 조사완료 목록 건수 조회
     -->
    <select id="selectBscSvyComptLstCnt" parameterType="hashMap" resultType="int">
    	SELECT COUNT(*)
    	FROM TF_FEIS_BSC_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_BSC_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_BSC_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''"><![CDATA[ AND
		COALESCE((SELECT MBER_NM FROM TN_FEIS_GNRLMBER WHERE MBER_ID = TRIM(B.SVYUSER)),COALESCE((SELECT MBER_NM FROM TN_FEIS_GNRLMBER WHERE MBER_ID = A.LOGIN_ID),TRIM(B.SVYUSER))) LIKE CONCAT ('%', #{user},'%')	]]>
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectBscSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 기초조사 조사완료 목록조회
     -->
    <select id="selectBscSvyComptLst" parameterType="hashMap" resultType="egovMap">
		SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
            ,COALESCE(A.SMID::TEXT, '') AS SMID <!--슈퍼맵아이디-->
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID <!--공유방아이디-->
			,COALESCE(A.GID::TEXT, '') AS GID <!--고유아이디-->
			,COALESCE(B.SVYID::TEXT, '') AS SVYID <!--조사아이디-->
			,COALESCE(B.SVYTYPE, '') AS SVYTYPE <!--조사유형-->
			,COALESCE(B.SVYDT, '') AS SVYDT <!--조사일-->
			,COALESCE(B.SVYUSER, '') AS SVYUSER <!--조사자-->
			,COALESCE(B.SD, '') AS SD <!--시도-->
			,COALESCE(B.SGG, '') AS SGG <!--시군구-->
			,COALESCE(B.EMD, '') AS EMD <!--읍면동-->
			,COALESCE(B.RI, '') AS RI <!--리-->
			,COALESCE(B.JIBUN, '') AS JIBUN <!--지번--> 
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON <!--경도-->
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT <!--위도-->
			,COALESCE(B.REGION1, '') AS REGION1 <!-- 관할1-->
			,COALESCE(B.REGION2, '') AS REGION2 <!-- 관할2-->			
			,COALESCE(B.SAFTYVAL, '') AS SAFTYVAL <!--보호대상측정값-->
			,COALESCE(B.SAFTYSCORE, '') AS SAFTYSCORE <!--보호대상점수-->
			,COALESCE(B.TLTRNTLTVAL, '') AS TLTRNTLTVAL <!--총계류길이측정값-->
			,COALESCE(B.TLTRNTLTSCORE, '') AS TLTRNTLTSCORE <!--총계류길이점수-->
			,COALESCE(B.TRNTAVGSLPVAL, '') AS TRNTAVGSLPVAL <!--계류평균경사측정값-->
			,COALESCE(B.TRNTAVGSLPSCORE, '') AS TRNTAVGSLPSCORE  <!--계류평균경사점수-->
			,COALESCE(B.DEVOCCAUSEVAL, '') AS DEVOCCAUSEVAL <!--황폐발생원측정값-->
			,COALESCE(B.DEVOCCAUSESCORE, '') AS DEVOCCAUSESCORE <!--황폐발생원점수-->
			,COALESCE(B.WCLCTAREAVAL, '') AS WCLCTAREAVAL <!--집수면적측정값-->
			,COALESCE(B.WCLCTAREASCORE, '') AS WCLCTAREASCORE <!--집수면적점수-->
			,COALESCE(B.DISTBMDSBRATEVAL, '') AS DISTBMDSBRATEVAL <!--전석분포비율측정값-->
			,COALESCE(B.DISTBMDSBRATESCORE, '') AS DISTBMDSBRATESCORE <!--전석분포비율점수 -->
			,COALESCE(B.SLENVAL, '') AS SLENVAL <!--경사길이측정값-->
			,COALESCE(B.SLENSCORE, '') AS SLENSCORE <!--경사길이점수-->
			,COALESCE(B.SLOPEVAL, '') AS SLOPEVAL <!--경사도측정값-->
			,COALESCE(B.SLOPESCORE, '') AS SLOPESCORE <!--경사도점수-->
			,COALESCE(B.SFORMVAL, '') AS SFORMVAL <!--사면형측정값-->
			,COALESCE(B.SFORMSCORE, '') AS SFORMSCORE <!--사면형점수-->
			,COALESCE(B.FRSTFRVAL, '') AS FRSTFRVAL <!--임상측정값-->
			,COALESCE(B.FRSTFRSCORE, '') AS FRSTFRSCORE <!--임상점수-->
			,COALESCE(B.PRNTRCKVAL, '') AS PRNTRCKVAL <!--모암측정값-->
			,COALESCE(B.PRNTRCKSCORE, '') AS PRNTRCKSCORE <!--모암점수-->
			,COALESCE(B.RSKFACTORVAL, '') AS RSKFACTORVAL <!--위험인자측정값-->
			,COALESCE(B.RSKFACTORSCORE, '') AS RSKFACTORSCORE <!--위험인자점수 -->
			,COALESCE(B.MAINRISK, '') AS MAINRISK <!--주요위험성-->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_BSC_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_BSC_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_BSC_CNRSSPCE C		
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''">
		AND B.SVYUSER = #{user}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>
		AND A.SMGEOMETRY IS NOT NULL
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>
    
    <select id="selectBscSvyComptLstSmid" parameterType="hashMap" resultType="String">
		SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_BSC_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_BSC_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_BSC_CNRSSPCE C			
		WHERE 
			1=1
		AND A.MST_ID = C.ID			
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''">
		AND B.SVYUSER = #{user}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectLcpSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer}
    @description 땅밀림 실태조사 조사완료 목록 건수 조회
     -->
    <select id="selectLcpSvyComptLstCnt" parameterType="hashMap" resultType="int">
   		SELECT COUNT(*)
    	FROM TF_FEIS_LCP_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_LCP_SVYMEMO AS B
		ON A.GID = B.GID
		,TN_FEIS_LCP_CNRSSPCE C
		WHERE
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="lastgrd != null and lastgrd != ''">
		AND B.LASTGRD = #{lastgrd}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY LIKE '%' || SUBSTRING(#{soilty} FROM 1 for 5) || '%'
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
 		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND substring(B.FRSTFRVAL FROM 1 FOR 4) LIKE '%' || SUBSTRING(#{frstfrval} FROM 1 for 4) || '%'
		</if>
    </select>
    <!-- 
    @author ipodo
    @name selectLcpSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 땅밀림 실태조사 조사완료 목록조회
     -->    
    <select id="selectLcpSvyComptLst" parameterType="hashMap" resultType="egovMap">
    	SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
			,COALESCE(A.SMID::TEXT, '') AS SMID
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID
			,COALESCE(A.GID::TEXT, '') AS GID
			,COALESCE(B.SVYID, '') AS SVYID
			,COALESCE(B.SVYUSER, '') AS SVYUSER
			,COALESCE(B.LASTGRD, '') AS LASTGRD		
			,COALESCE(B.SVYDT, '') AS SVYDT
			,COALESCE(B.SD, '') AS SD
			,COALESCE(B.SGG, '') AS SGG
			,COALESCE(B.EMD, '') AS EMD
			,COALESCE(B.RI, '') AS RI
			,COALESCE(B.JIBUN,  '') AS JIBUN
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT
			,COALESCE(B.CMPROKSCORE,  '') AS CMPROKSCORE <!--주구성암석-->
			,COALESCE(B.ROKWTHRSCORE,  '') AS ROKWTHRSCORE <!--암석풍화-->
			,COALESCE(B.SOILTY, '') AS SOILTY <!--토양형-->
			,COALESCE(B.TALUSATSCORE, '') AS TALUSATSCORE <!-- 너덜유무-->
			,COALESCE(B.TPGRPHVAL, '') AS TPGRPHVAL <!--지형구분-->
			,COALESCE(B.PLNFORMSCORE, '') AS PLNFORMSCORE <!--평면형-->
			,COALESCE(B.LNGFORMSCORE,  '') AS LNGFORMSCORE <!--종단면형-->
			,COALESCE(B.SLPRNGSCORE,  '') AS SLPRNGSCORE <!-- 경사도-->
			,COALESCE(B.FRSTFRVAL, '') AS FRSTFRVAL <!--임상-->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_LCP_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_LCP_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_LCP_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="lastgrd != null and lastgrd != ''">
		AND B.LASTGRD = #{lastgrd}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>			
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY LIKE '%' || SUBSTRING(#{soilty} FROM 1 for 5) || '%'
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
 		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND substring(B.FRSTFRVAL FROM 1 FOR 4) LIKE '%' || SUBSTRING(#{frstfrval} FROM 1 for 4) || '%'
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10		
    </select>
    
    <select id="selectLcpSvyComptLstSmid" parameterType="hashMap" resultType="String">
    	SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_LCP_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_LCP_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_LCP_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="lastgrd != null and lastgrd != ''">
		AND B.LASTGRD = #{lastgrd}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>			
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY LIKE '%' || SUBSTRING(#{soilty} FROM 1 for 5) || '%'
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
 		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND substring(B.FRSTFRVAL FROM 1 FOR 4) LIKE '%' || SUBSTRING(#{frstfrval} FROM 1 for 4) || '%'
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectWkaSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer}
    @description 취약지역 실태조사 목록 건수 조회
     -->    
    <select id="selectWkaSvyComptLstCnt" parameterType="hashMap" resultType="int">
     	SELECT COUNT(*)
    	FROM TF_FEIS_WKA_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_WKA_SVYMEMO01 AS B 
		ON A.GID = B.GID
		LEFT JOIN TN_FEIS_WKA_SVYMEMO02 AS C
		ON A.GID = C.GID 
		LEFT JOIN TN_FEIS_WKA_SVYMEMO03 AS D
		ON A.GID = D.GID 		
		,TN_FEIS_WKA_CNRSSPCE E
		WHERE 
			1=1
		AND A.MST_ID = E.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and dglog != null and dglog != ''">
		AND C.DGLOGSCORE = #{dglog}
		</if>
		<if test="svytype.equals('토석류') and dglog2 != null and dglog2 != ''">
		AND C.DGLOGSCORE = #{dglog2}
		</if>
		<if test="svytype.equals('산사태') and direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>
		<if test="svytype.equals('토석류') and direffcsafe2 != null and direffcsafe2 != ''">
		AND C.DIREFFCSCORE = #{direffcsafe2}
		</if> 
		<if test="svytype.equals('산사태') and crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="svytype.equals('산사태') and clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="svytype.equals('산사태') and surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="svytype.equals('산사태') and wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="svytype.equals('산사태') and lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="svytype.equals('산사태') and watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="svytype.equals('토석류') and clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="svytype.equals('토석류') and corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="svytype.equals('토석류') and bldrstnescore != null and bldrstnescore != ''">
		AND C.BLDRSTNESCORE = #{bldrstnescore}
		</if>   
		<if test="svytype.equals('토석류') and soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="svytype.equals('토석류') and foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="svytype.equals('토석류') and rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
    </select>
    <!-- 
    @author ipodo
    @name selectWkaSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 취약지역 실태조사 목록조회
     -->    
    <select id="selectWkaSvyComptLst" parameterType="hashMap" resultType="egovMap">
		SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
			,COALESCE(A.SMID::TEXT, '') AS SMID
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID
			,COALESCE(A.GID::TEXT, '') AS GID
			,COALESCE(B.SVYID, '') AS SVYID
			,COALESCE(B.SVYUSER, '') AS SVYUSER
			,COALESCE(REGEXP_REPLACE((REGEXP_SPLIT_TO_ARRAY(B.SVYTYPE, '\('))[2],'\)+',''), '') AS SVYTYPE
			,COALESCE(B.SVYDT, '') AS SVYDT
			,COALESCE(B.SD, '') AS SD
			,COALESCE(B.SGG, '') AS SGG
			,COALESCE(B.EMD, '') AS EMD
			,COALESCE(B.RI, '') AS RI
			,COALESCE(B.JIBUN,  '') AS JIBUN
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT
			,COALESCE(C.DGLOG, '') AS DGLOG <!--피해이력-->
			,COALESCE(C.DIREFFCSAFE, '') AS DIREFFCSAFE <!--직접영향권 내 보호시설-->
			,COALESCE(C.CRCKSITTN, '') AS CRCKSITTN <!--균열상황-->
			,COALESCE(C.CLPS, '') AS CLPS <!--균열-->
			,COALESCE(C.SURFACEDIR, '') AS SURFACEDIR <!--불연속면방향-->
			,COALESCE(C.WTRSTTUS, '') AS WTRSTTUS <!--풍화상태-->
			,COALESCE(C.LNDSLDDGSCORE, '') AS LNDSLDDGSCORE <!--산사태위험등급-->
			,COALESCE(C.WATERSTTUS, '') AS WATERSTTUS <!--용수상황-->
			,COALESCE(C.CLPSSCORE, '') AS CLPSSCORE <!--붕괴-->
			,COALESCE(C.CORROSIONSCORE, '') AS CORROSIONSCORE <!--침식-->
			,COALESCE(C.BLDRSTNESCORE, '') AS BLDRSTNESCORE <!--전석-->
			,COALESCE(C.SOILTRACESCORE, '') AS SOILTRACESCORE <!--토석류흔적-->
			,COALESCE(C.FORESTSTTUSSCORE, '') AS FORESTSTTUSSCORE <!--산림현황-->
			,COALESCE(C.ROOTCHARSCORE, '') AS ROOTCHARSCORE <!--뿌리특성-->		
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_WKA_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_WKA_SVYMEMO01 AS B 
		ON A.GID = B.GID
		LEFT JOIN TN_FEIS_WKA_SVYMEMO02 AS C
		ON A.GID = C.GID 
		LEFT JOIN TN_FEIS_WKA_SVYMEMO03 AS D
		ON A.GID = D.GID 		
		,TN_FEIS_WKA_CNRSSPCE E
		WHERE 
			1=1
		AND A.MST_ID = E.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and dglog != null and dglog != ''">
		AND C.DGLOGSCORE = #{dglog}
		</if>
		<if test="svytype.equals('토석류') and dglog2 != null and dglog2 != ''">
		AND C.DGLOGSCORE = #{dglog2}
		</if>
		<if test="svytype.equals('산사태') and direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>
		<if test="svytype.equals('토석류') and direffcsafe2 != null and direffcsafe2 != ''">
		AND C.DIREFFCSCORE = #{direffcsafe2}
		</if> 
		<if test="svytype.equals('산사태') and crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="svytype.equals('산사태') and clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="svytype.equals('산사태') and surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="svytype.equals('산사태') and wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="svytype.equals('산사태') and lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="svytype.equals('산사태') and watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="svytype.equals('토석류') and clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="svytype.equals('토석류') and corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="svytype.equals('토석류') and bldrstnescore != null and bldrstnescore != ''">
		AND C.BLDRSTNESCORE = #{bldrstnescore}
		</if>   
		<if test="svytype.equals('토석류') and soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="svytype.equals('토석류') and foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="svytype.equals('토석류') and rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>
    
    <select id="selectWkaSvyComptLstSmid" parameterType="hashMap" resultType="String">
		SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_WKA_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_WKA_SVYMEMO01 AS B 
		ON A.GID = B.GID
		LEFT JOIN TN_FEIS_WKA_SVYMEMO02 AS C
		ON A.GID = C.GID 
		LEFT JOIN TN_FEIS_WKA_SVYMEMO03 AS D
		ON A.GID = D.GID 		
		,TN_FEIS_WKA_CNRSSPCE E
		WHERE 
			1=1
		AND A.MST_ID = E.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and dglog != null and dglog != ''">
		AND C.DGLOGSCORE = #{dglog}
		</if>
		<if test="svytype.equals('토석류') and dglog2 != null and dglog2 != ''">
		AND C.DGLOGSCORE = #{dglog2}
		</if>
		<if test="svytype.equals('산사태') and direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>
		<if test="svytype.equals('토석류') and direffcsafe2 != null and direffcsafe2 != ''">
		AND C.DIREFFCSCORE = #{direffcsafe2}
		</if> 
		<if test="svytype.equals('산사태') and crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="svytype.equals('산사태') and clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="svytype.equals('산사태') and surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="svytype.equals('산사태') and wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="svytype.equals('산사태') and lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="svytype.equals('산사태') and watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="svytype.equals('토석류') and clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="svytype.equals('토석류') and corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="svytype.equals('토석류') and bldrstnescore != null and bldrstnescore != ''">
		AND C.BLDRSTNESCORE = #{bldrstnescore}
		</if>   
		<if test="svytype.equals('토석류') and soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="svytype.equals('토석류') and foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="svytype.equals('토석류') and rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectCnlSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer}
    @description 취약지역 해제조사 조사완료 목록 건수 조회
     -->    
    <select id="selectCnlSvyComptLstCnt" parameterType="hashMap" resultType="int">
    	SELECT COUNT(*)
    	FROM TF_FEIS_CNL_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_CNL_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_CNL_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectCnlSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 취약지역 해제조사 조사완료 목록조회
     -->    
    <select id="selectCnlSvyComptLst" parameterType="hashMap" resultType="egovMap">
		SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
			,COALESCE(A.SMID::TEXT, '') AS SMID
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID
			,COALESCE(A.GID::TEXT, '') AS GID
			,COALESCE(B.SVYID, '') AS SVYID
			,COALESCE(B.SVYUSER, '') AS SVYUSER
			,COALESCE(REGEXP_REPLACE((REGEXP_SPLIT_TO_ARRAY(B.SVYTYPE, '\('))[2],'\)+',''), '') AS SVYTYPE
			,COALESCE(B.SVYDT, '') AS SVYDT
			,COALESCE(B.SD, '') AS SD
			,COALESCE(B.SGG, '') AS SGG
			,COALESCE(B.EMD, '') AS EMD
			,COALESCE(B.RI, '') AS RI
			,COALESCE(B.JIBUN,  '') AS JIBUN
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT
			,COALESCE(B.BIZTYPE, '') AS BIZTYPE <!--사업종류-->
			,COALESCE(B.APPLCEGNERMHD, '') AS APPLCEGNERMHD <!--적용공법-->
			,COALESCE(B.DSSTROCCRRNCAT, '') AS DSSTROCCRRNCAT <!--재해발생여부-->
			,COALESCE(B.SSTTUS, '') AS SSTTUS <!--사면상태-->
			,COALESCE(B.STABLEINTRPRTSCORE, '') AS STABLEINTRPRTSCORE <!--안정해석 결과-->
			,COALESCE(B.MRNGSTTUS, '') AS MRNGSTTUS <!--계류상태-->
			,COALESCE(B.SIMLATNRSLTYN, '') AS SIMLATNRSLTYN <!--시뮬레이션결과-->
			,COALESCE(B.REDUCAT, '') AS REDUCAT <!--저감여부(안정해석결과)-->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_CNL_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_CNL_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_CNL_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>

	<select id="selectCnlSvyComptLstSmid" parameterType="hashMap" resultType="String">
		SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_CNL_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_CNL_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_CNL_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectAprSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer} 
    @description 외관점검 조사완료 목록 건수 조회
     -->    
    <select id="selectAprSvyComptLstCnt" parameterType="hashMap" resultType="int">
    	SELECT COUNT(*)
		FROM TF_FEIS_FCK_APRCOMPT AS A
		LEFT JOIN TN_FEIS_FCK_APRMEMO AS B
		ON A.GID = B.GID
		,TN_FEIS_APR_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('사방댐 외관점검') and orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%',#{orginldamval},'%') 
		</if>
		<if test="svytype.equals('사방댐 외관점검') and orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="svytype.equals('사방댐 외관점검') and sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="svytype.equals('사방댐 외관점검') and sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="svytype.equals('사방댐 외관점검') and dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="svytype.equals('사방댐 외관점검') and dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="svytype.equals('산지사방 외관점검') and reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="svytype.equals('산지사방 외관점검') and prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="svytype.equals('산지사방 외관점검') and drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="svytype.equals('계류보전 외관점검') and chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="svytype.equals('계류보전 외관점검') and rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="svytype.equals('계류보전 외관점검') and grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectAprSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 외관점검 조사완료 목록조회
     -->    
    <select id="selectAprSvyComptLst" parameterType="hashMap" resultType="egovMap">
    	SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
			,COALESCE(A.SMID::TEXT, '') AS SMID
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID
			,COALESCE(A.GID::TEXT, '') AS GID
			,COALESCE(B.SVYID, '') AS SVYID
			,COALESCE(B.SVYUSER, '') AS SVYUSER
			,COALESCE(B.SVYTYPE, '') AS SVYTYPE
			,COALESCE(B.SVYDT, '') AS SVYDT
			,COALESCE(B.SD, '') AS SD
			,COALESCE(B.SGG, '') AS SGG
			,COALESCE(B.EMD, '') AS EMD
			,COALESCE(B.RI, '') AS RI
			,COALESCE(B.JIBUN,  '') AS JIBUN
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT
			,COALESCE(B.FCLTYEAR, '') AS FCLTYEAR <!-- 시설제원연도 -->
			,COALESCE(B.FCLTUPRHG, '') AS FCLTUPRHG <!-- 시설제원상장 -->
			,COALESCE(B.FCLTLWRHG, '') AS FCLTLWRHG <!-- 시설제원하장 -->
			,COALESCE(B.FCLTSTKHG, '') AS FCLTSTKHG <!-- 시설제원유효고 -->			
			,COALESCE(B.ORGINLDAMVAL, '') AS ORGINLDAMVAL <!--본댐 측정값-->
			,COALESCE(B.ORGINLDAMJDGVAL, '') AS ORGINLDAMJDGVAL <!--본댐 판정값-->
			,COALESCE(B.SIDEWALLVAL, '') AS SIDEWALLVAL <!--측벽 측정값-->
			,COALESCE(B.SIDEWALLJDGVAL, '') AS SIDEWALLJDGVAL <!--측벽 판정값-->
			,COALESCE(B.DWNSPTVAL, '') AS DWNSPTVAL <!--물받이 측정값-->
			,COALESCE(B.DWNSPTJDGVAL, '') AS DWNSPTJDGVAL <!--물받이 판정값-->
			,COALESCE(B.REINFCVAL, '') AS REINFCVAL <!--보강시설측정값-->
			,COALESCE(B.REINFCJDGVAL, '') AS REINFCJDGVAL <!--보강시설판정값-->
			,COALESCE(B.PRTCVAL, '') AS PRTCVAL <!--보호시설측정값-->
			,COALESCE(B.PRTCJDGVAL, '') AS PRTCJDGVAL <!--보호시설판정값-->
			,COALESCE(B.DRNGVAL, '') AS DRNGVAL <!--배수시설측정값-->
			,COALESCE(B.DRNGJDGVAL, '') AS DRNGJDGVAL <!--배수시설 판정값-->
			,COALESCE(B.CHKDAMVAL, '') AS CHKDAMVAL <!--골막이측정값-->
			,COALESCE(B.CHKDAMJDGVAL, '') AS CHKDAMJDGVAL <!--골막이판정값-->
			,COALESCE(B.RVTMNTVAL, '') AS RVTMNTVAL <!--기슭막이측정값-->
			,COALESCE(B.RVTMNTJDGVAL, '') AS RVTMNTJDGVAL <!--기슭막이판정값-->
			,COALESCE(B.GRDSTABLVAL, '') AS GRDSTABLVAL <!--바닥막이측정값-->
			,COALESCE(B.GRDSTABLJDGVAL, '') AS GRDSTABLJDGVAL <!--바닥막이판정값-->
			,COALESCE(B.ETCJDGVAL, '') AS ETCJDGVAL <!-- 기타_판정값 -->
			,COALESCE(B.FLUGTJDGVAL, '') AS FLUGTJDGVAL <!-- 수문_판정값 -->
			,COALESCE(B.CSTRDCPRVNJDGVAL, '') AS CSTRDCPRVNJDGVAL <!-- 침식방지_판정값 -->
			,COALESCE(B.VTNSTTUSJDGVAL, '') AS VTNSTTUSJDGVAL <!-- 식생상태_판정값 -->
			,COALESCE(B.SNDDPSITJDGVAL, '') AS SNDDPSITJDGVAL <!-- 저사상태_판정값 -->
			,COALESCE(B.SNDDPSITVAL, '') AS SNDDPSITVAL <!-- 저사상태_측정값 -->
			,COALESCE(B.FCKRSLT, '') AS FCKRSLT <!-- 최종점검결과 -->
			,COALESCE(B.APPNRELIS, '') AS APPNRELIS <!-- 지정해제 -->
			,COALESCE(B.MNGMTR, '') AS MNGMTR <!-- 조치사항 -->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_FCK_APRCOMPT AS A
		LEFT JOIN TN_FEIS_FCK_APRMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_APR_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('사방댐 외관점검') and orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%',#{orginldamval},'%') 
		</if>
		<if test="svytype.equals('사방댐 외관점검') and orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="svytype.equals('사방댐 외관점검') and sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="svytype.equals('사방댐 외관점검') and sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="svytype.equals('사방댐 외관점검') and dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="svytype.equals('사방댐 외관점검') and dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="svytype.equals('산지사방 외관점검') and reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="svytype.equals('산지사방 외관점검') and prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="svytype.equals('산지사방 외관점검') and drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="svytype.equals('계류보전 외관점검') and chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="svytype.equals('계류보전 외관점검') and rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="svytype.equals('계류보전 외관점검') and grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>
    
    <select id="selectAprSvyComptLstSmid" parameterType="hashMap" resultType="String">
    	SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_FCK_APRCOMPT AS A
		LEFT JOIN TN_FEIS_FCK_APRMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_APR_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('사방댐 외관점검') and orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%',#{orginldamval},'%') 
		</if>
		<if test="svytype.equals('사방댐 외관점검') and orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="svytype.equals('사방댐 외관점검') and sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="svytype.equals('사방댐 외관점검') and sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="svytype.equals('사방댐 외관점검') and dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="svytype.equals('사방댐 외관점검') and dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="svytype.equals('산지사방 외관점검') and reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="svytype.equals('산지사방 외관점검') and prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="svytype.equals('산지사방 외관점검') and drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="svytype.equals('산지사방 외관점검') and drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="svytype.equals('계류보전 외관점검') and chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="svytype.equals('계류보전 외관점검') and rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="svytype.equals('계류보전 외관점검') and grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="svytype.equals('계류보전 외관점검') and grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectFrdSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer}
    @description 임도타당성평가 조사완료 목록 건수 조회
     -->
    <select id="selectFrdSvyComptLstCnt" parameterType="hashMap" resultType="int">
    	SELECT COUNT(*)
    	FROM TF_FEIS_FRD_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_FRD_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_FRD_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
<!-- 		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct}) -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYINSTLLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})	
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYNCSTYLIST::jsonb) AS ELEM WHERE ELEM->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectFrdSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 임도타당성평가 조사완료 목록조회
     -->
    <select id="selectFrdSvyComptLst" parameterType="hashMap" resultType="egovMap">
		SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD')) AS NUM
            ,COALESCE(A.SMID::TEXT, '') AS SMID <!--슈퍼맵아이디-->
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID <!--공유방아이디-->
			,COALESCE(A.GID::TEXT, '') AS GID <!--고유아이디-->
			,COALESCE(B.SVYID::TEXT, '') AS SVYID <!--조사아이디-->
			,COALESCE(B.FRDTYPE, '') AS FRDTYPE <!--임도종류-->
			,COALESCE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), '') AS SVYDT <!--조사일-->
			,COALESCE(B.SVYUSER, '') AS SVYUSER <!--조사자-->
			,COALESCE(B.SD, '') AS SD <!--시도-->
			,COALESCE(B.SGG, '') AS SGG <!--시군구-->
			,COALESCE(B.EMD, '') AS EMD <!--읍면동-->
			,COALESCE(B.RI, '') AS RI <!--리-->
			,COALESCE(B.JIBUN, '') AS JIBUN <!--지번--> 
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON <!--경도-->
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT <!--위도-->
			,COALESCE(B.COMPENTAUTH, '') AS REGION1 <!-- 관할1-->
			,COALESCE(B.SUBCOMPENTAUTH, '') AS REGION2 <!-- 관할2-->			
			,COALESCE(B.SCHDST, '') AS SCHDST<!-- 예정거리 -->
			,COALESCE(B.FRDEXTNS, '') AS FRDEXTNS<!-- 임도연장 -->
			,COALESCE(B.SAFEFCT, '') AS SAFEFCT<!-- 보호시설 -->
			,COALESCE(B.FIELD, '') AS FIELD<!-- 전답 -->
			,COALESCE(B.ACSBL, '') AS ACSBL<!-- 접근성 -->
			,COALESCE(B.LONSLOPEMIN, '') AS lonslopemin<!-- 종단기울기 최소 -->
			,COALESCE(B.LONSLOPEMAX, '') AS LONSLOPEMAX<!-- 종단기울기 최대 -->
			,COALESCE(B.LONSLOPEAVG, '') AS LONSLOPEAVG<!-- 종단기울기 평균 -->
			,COALESCE(B.MTSLOPEMIN, '') AS MTSLOPEMIN<!-- 산지경사 최소 -->
			,COALESCE(B.MTSLOPEMAX, '') AS MTSLOPEMAX<!-- 산지경사 최대 -->
			,COALESCE(B.MTSLOPEAVG, '') AS MTSLOPEAVG<!-- 산지경사 평균 -->
			,COALESCE(B.AFRSTAT, '') AS AFRSTAT<!-- 조림지 유무 -->
			,COALESCE(B.CUTTINGAT, '') AS CUTTINGAT<!-- 벌채지 유무 -->
			,JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) AS STONYLAND<!-- 석력지 유무 -->
			,COALESCE(B.WETLANDAT, '') AS WETLANDAT<!-- 습지 유무 -->
			,COALESCE(B.CMTRYAT, '') AS CMTRYAT<!-- 묘지 유무 -->
			,COALESCE(B.ELTNWATERAT, '') AS ELTNWATERAT<!-- 용출수 유무 -->
			,COALESCE(B.SOFRTGRNDAT, '') AS SOFRTGRNDAT<!-- 연약지반 유무 -->
			,COALESCE(B.MAINTREEKNDCNT, '') AS MAINTREEKNDCNT<!-- 주요수종 건수 -->
			,COALESCE(B.MAINVEGCNT, '') AS MAINVEGCNT<!-- 주요식생 건수-->
			,COALESCE(B.WTRPLTNAT, '') AS WTRPLTNAT<!-- 상수원오염 유무 -->
			,COALESCE(B.DMGCNCRNAT, '') AS DMGCNCRNAT<!-- 과다훼손우려지 유무 -->
			,COALESCE(B.FRSTDSSTRCNT, '') AS FRSTDSSTRCNT<!-- 산림재해 건수 -->
			,COALESCE(B.WILDANMLKIND, '') AS WILDANMLKIND<!-- 야생동물 건수 -->
			,COALESCE(B.ECNRFCLTYINSTLTYPE, '') AS ECNRFCLTYINSTLCNT<!-- 사방시설설치 건수 -->
			,COALESCE(B.ECNRFCLTYNCSTYTYPE, '') AS ECNRFCLTYNCSTYCNT<!-- 사방시설필요 건수 -->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_FRD_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_FRD_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_FRD_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYINSTLLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})	
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYNCSTYLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>
    
    <select id="selectFrdSvyComptLstSmid" parameterType="hashMap" resultType="String">
		SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_FRD_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_FRD_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_FRD_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})	
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
		 AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYINSTLLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})	
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYNCSTYLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectMseSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer}
    @description 계측기 조사완료 목록 건수 조회
     -->
    <select id="selectMseSvyComptLstCnt" parameterType="hashMap" resultType="int">
    	SELECT COUNT(*)
    	FROM TF_FEIS_MSE_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_MSE_SVYMEMO AS B 
		ON A.GID = B.GID
		WHERE 
			1=1
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectMseSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 계측기 조사완료 목록조회
     -->
    <select id="selectMseSvyComptLst" parameterType="hashMap" resultType="egovMap">
		SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
            ,COALESCE(A.SMID::TEXT, '') AS SMID <!--슈퍼맵아이디-->
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID <!--공유방아이디-->
			,COALESCE(A.GID::TEXT, '') AS GID <!--고유아이디-->
			,COALESCE(B.SVYID::TEXT, '') AS SVYID <!--조사아이디-->
			,COALESCE(B.SVYTYPE, '') AS SVYTYPE <!--조사유형-->
			,COALESCE(B.SVYDT, '') AS SVYDT <!--조사일-->
			,COALESCE(B.SVYUSER, '') AS SVYUSER <!--조사자-->
			,COALESCE(B.SD, '') AS SD <!--시도-->
			,COALESCE(B.SGG, '') AS SGG <!--시군구-->
			,COALESCE(B.EMD, '') AS EMD <!--읍면동-->
			,COALESCE(B.RI, '') AS RI <!--리-->
			,COALESCE(B.JIBUN, '') AS JIBUN <!--지번--> 
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON <!--경도-->
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT <!--위도-->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_MSE_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_MSE_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_MSE_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>
    
    <select id="selectMseSvyComptLstSmid" parameterType="hashMap" resultType="String">
		SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_MSE_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_MSE_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_MSE_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
    </select>
    
    
    <!-- 
    @author ipodo
    @name selectPcsSvyComptLstCnt
    @param {HashMap} hashMap - key value
    @returns {Integer} 
    @description 정밀점검 조사완료 목록 건수 조회
     -->    
    <select id="selectPcsSvyComptLstCnt" parameterType="hashMap" resultType="int">
    	SELECT COUNT(*)
		FROM TF_FEIS_PCS_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_PCS_SVYMEMO AS B
		ON A.GID = B.GID
		,TN_FEIS_PCS_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectPcsSvyComptLst
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 정밀점검 조사완료 목록조회
     -->    
    <select id="selectPcsSvyComptLst" parameterType="hashMap" resultType="egovMap">
    	SELECT 
			ROW_NUMBER() OVER(ORDER BY TO_DATE(B.SVYDT, 'YYYY-MM-DD')) AS NUM
			,COALESCE(A.SMID::TEXT, '') AS SMID
			,COALESCE(A.MST_ID::TEXT, '') AS MST_ID
			,COALESCE(A.GID::TEXT, '') AS GID
			,COALESCE(B.SVYID, '') AS SVYID
			,COALESCE(B.SVYUSER, '') AS SVYUSER
			,COALESCE(B.SVYTYPE, '') AS SVYTYPE
			,COALESCE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), '') AS SVYDT
			,COALESCE(B.SD, '') AS SD
			,COALESCE(B.SGG, '') AS SGG
			,COALESCE(B.EMD, '') AS EMD
			,COALESCE(B.RI, '') AS RI
			,COALESCE(B.JIBUN,  '') AS JIBUN
			,COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LON
			,COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY))::TEXT, '') AS LAT
			,COALESCE(B.ECNRKND, '') AS ECNRKND <!-- 사방댐종류 -->
			,COALESCE(B.FCLTYEAR, '') AS FCLTYEAR <!-- 시설년도 -->
			,COALESCE(B.SVYFORM, '') AS SVYFORM <!-- 형식 -->
			,COALESCE(B.FCLTUPRHG, '') AS FCLTUPRHG <!--  -->
			,COALESCE(B.FCLTLWRHG, '') AS FCLTLWRHG <!--  -->
			,COALESCE(B.FCLTSTKHG, '') AS FCLTSTKHG <!--  -->
			,COALESCE(B.ECNRRNUM, '') AS ECNRRNUM <!--  -->
			,COALESCE(B.NATIONSPOTNUM, '') AS NATIONSPOTNUM <!--  -->
			,COALESCE(B.TTHGHJDGVAL, '') AS TTHGHJDGVAL <!--  -->
			,COALESCE(B.WOTDJDGVAL, '') AS WOTDJDGVAL <!--  -->
			,COALESCE(B.CNSTRCOST, '') AS CNSTRCOST <!--  -->
			,COALESCE(B.SIDEWALLLNG, '') AS SIDEWALLLNG <!--  -->
			,COALESCE(B.SIDEWALLHEG, '') AS SIDEWALLHEG <!--  -->
			,COALESCE(B.DWNSPTHRZ, '') AS DWNSPTHRZ <!--  -->
			,COALESCE(B.DWNSPTVTC, '') AS DWNSPTVTC <!--  -->
			,COALESCE(B.DSNTAREA, '') AS DSNTAREA <!--  -->
			,COALESCE(B.ECWNM, '') AS ECWNM <!--  -->
			,COALESCE(B.MAINSTRUCT, '') AS MAINSTRUCT <!--  -->
			,COALESCE(B.DRDGNATJDG, '') AS DRDGNATJDG <!-- 사방댐 준설여부 판정 -->
			,COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'') AS PNU <!-- pnu -->
		FROM TF_FEIS_PCS_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_PCS_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_PCS_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
		LIMIT 10 OFFSET (#{page}::NUMERIC - 1) * 10
    </select>
    
    <select id="selectPcsSvyComptLstSmid" parameterType="hashMap" resultType="String">
    	SELECT 
			ARRAY_TO_STRING(ARRAY_AGG(SMID),',') AS IDS
		FROM TF_FEIS_PCS_SVYCOMPT AS A
		LEFT JOIN TN_FEIS_PCS_SVYMEMO AS B 
		ON A.GID = B.GID
		,TN_FEIS_PCS_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
    </select>
    
    
    <!-- 
    @author ipodo
    @name selectBscSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 기초조사 조사완료 벡터 처리용
     -->
    <select id="selectBscSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(B.SVYDT, ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'')<!-- pnu -->
		    ) AS RESULT
		FROM
		    TF_FEIS_BSC_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_BSC_SVYMEMO AS B ON A.GID = B.GID
			,TN_FEIS_BSC_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''">
		AND B.SVYUSER = #{user}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectLcpSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 땅밀림 실태조사 조사완료 벡터 처리용
     -->
    <select id="selectLcpSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(B.SVYDT, ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'')<!-- pnu -->
		    ) AS RESULT
		FROM
		    TF_FEIS_LCP_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_LCP_SVYMEMO AS B ON A.GID = B.GID
			,TN_FEIS_LCP_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
	    AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>			
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY LIKE '%' || SUBSTRING(#{soilty} FROM 1 for 5) || '%'
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND substring(B.FRSTFRVAL FROM 1 FOR 4) LIKE '%' || SUBSTRING(#{frstfrval} FROM 1 for 4) || '%'
		</if> 
    </select>    
    
    <!-- 
    @author ipodo
    @name selectWkaSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 취약지역 실태조사 조사완료 벡터 처리용
     -->
    <select id="selectWkaSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(B.SVYDT, ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'')<!-- pnu -->
		    ) AS RESULT
		FROM
		    TF_FEIS_WKA_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_WKA_SVYMEMO01 AS B ON A.GID = B.GID
		    LEFT JOIN TN_FEIS_WKA_SVYMEMO02 AS C ON A.GID = C.GID
		    LEFT JOIN TN_FEIS_WKA_SVYMEMO03 AS D ON A.GID = D.GID
			,TN_FEIS_WKA_CNRSSPCE E
		WHERE 
			1=1
		AND A.MST_ID = E.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and dglog != null and dglog != ''">
		AND C.DGLOGSCORE = #{dglog}
		</if>
		<if test="svytype.equals('토석류') and dglog2 != null and dglog2 != ''">
		AND C.DGLOGSCORE = #{dglog2}
		</if>
		<if test="svytype.equals('산사태') and direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>
		<if test="svytype.equals('토석류') and direffcsafe2 != null and direffcsafe2 != ''">
		AND C.DIREFFCSCORE = #{direffcsafe2}
		</if> 
		<if test="crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="bldrstnescore != null and bldrstnescore != ''">
		AND C.BLDRSTNESCORE = #{bldrstnescore}
		</if>   
		<if test="soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
    </select>    
    
    <!-- 
    @author ipodo
    @name selectCnlSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 취약지역 해제조사 조사완료 벡터 처리용
     -->
    <select id="selectCnlSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(B.SVYDT, ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'')<!-- pnu -->
		    ) AS RESULT
		FROM
		    TF_FEIS_CNL_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_CNL_SVYMEMO AS B ON A.GID = B.GID
			,TN_FEIS_CNL_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
    </select>    
    
    <!-- 
    @author ipodo
    @name selectAprSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 외관점검 조사완료 벡터 처리용
     -->
    <select id="selectAprSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(B.SVYDT, ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),''),<!-- pnu -->
		        ';',	        
				COALESCE(B.FCLTYEAR, ''),
				';',
				COALESCE(B.FCLTUPRHG, ''),
				';',
				COALESCE(B.FCLTLWRHG, ''),
				';',
				COALESCE(B.FCLTSTKHG, ''),
				';',
				COALESCE(B.ORGINLDAMVAL, ''),
				';',
				COALESCE(B.ORGINLDAMJDGVAL, ''),
				';',
				COALESCE(B.SIDEWALLVAL, ''),
				';',
				COALESCE(B.SIDEWALLJDGVAL, ''),
				';',
				COALESCE(B.DWNSPTVAL, ''),
				';',
				COALESCE(B.DWNSPTJDGVAL, ''),
				';',
				COALESCE(B.REINFCVAL, ''),
				';',
				COALESCE(B.REINFCJDGVAL, ''),
				';',
				COALESCE(B.PRTCVAL, ''),
				';',
				COALESCE(B.PRTCJDGVAL, ''),
				';',
				COALESCE(B.DRNGVAL, ''),
				';',
				COALESCE(B.DRNGJDGVAL, ''),
				';',
				COALESCE(B.CHKDAMVAL, ''),
				';',
				COALESCE(B.CHKDAMJDGVAL, ''),
				';',
				COALESCE(B.RVTMNTVAL, ''),
				';',
				COALESCE(B.RVTMNTJDGVAL, ''),
				';',
				COALESCE(B.GRDSTABLVAL, ''),
				';',
				COALESCE(B.GRDSTABLJDGVAL, ''),
				';',
				COALESCE(B.ETCJDGVAL, ''),
				';',
				COALESCE(B.FLUGTJDGVAL, ''),
				';',
				COALESCE(B.CSTRDCPRVNJDGVAL, ''),
				';',
				COALESCE(B.VTNSTTUSJDGVAL, ''),
				';',
				COALESCE(B.SNDDPSITJDGVAL, ''),
				';',
				COALESCE(B.SNDDPSITVAL, ''),
				';',
				COALESCE(B.FCKRSLT, ''),
				';',
				COALESCE(B.APPNRELIS, ''),
				';',
				COALESCE(B.MNGMTR, '')   
		    ) AS RESULT
		FROM
		    TF_FEIS_FCK_APRCOMPT AS A
		    LEFT JOIN TN_FEIS_FCK_APRMEMO AS B 
		    ON A.GID = B.GID
			,TN_FEIS_APR_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%',#{orginldamval},'%') 
		</if>
		<if test="orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>	    
    </select>    
    
    <!-- 
    @author ipodo
    @name selectFrdSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 임도타당성평가 조사완료 벡터 처리용
     -->
    <select id="selectFrdSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.FRDTYPE, ''),
		        ';',
		        COALESCE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),''),<!-- pnu -->
		        ';',
		        COALESCE(A.ROUTE_TYPE, '')
		    ) AS RESULT
		FROM
 		    TF_FEIS_FRD_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_FRD_SVYMEMO AS B ON A.GID = B.GID
			,TN_FEIS_FRD_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
		AND EXISTS (SELECT 1 FROM jsonb_array_elements(B.ECNRFCLTYINSTLLIST::jsonb) AS elem WHERE elem->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM jsonb_array_elements(B.ECNRFCLTYNCSTYLIST::jsonb) AS elem WHERE elem->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
    </select> 
    
    <!-- 
    @author ipodo
    @name selectMseSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 계측기 조사완료 벡터 처리용
     -->
    <select id="selectMseSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'')<!-- pnu -->
		    ) AS RESULT
		FROM
		    TF_FEIS_MSE_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_MSE_SVYMEMO AS B ON A.GID = B.GID
			,TN_FEIS_MSE_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
    </select>
    
    <!-- 
    @author ipodo
    @name selectPcsSvyComptWKT
    @param {HashMap} hashMap - key value
    @returns {EgovMap} egovMap - list egovMap
    @description 정밀점검 조사완료 벡터 처리용
     -->
    <select id="selectPcsSvyComptWKT" parameterType="hashMap" resultType="String">
		SELECT
		    CONCAT(
		        ST_ASTEXT(A.SMGEOMETRY),
		        ';',
		        COALESCE(A.SMID :: TEXT, ''),
		        ';',
		        COALESCE(A.MST_ID :: TEXT, ''),
		        ';',
		        COALESCE(A.GID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYID :: TEXT, ''),
		        ';',
		        COALESCE(B.SVYTYPE, ''),
		        ';',
		        COALESCE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), ''),
		        ';',
		        COALESCE(B.SVYUSER, ''),
		        ';',
		        COALESCE(B.SD, ''),
		        ';',
		        COALESCE(B.SGG, ''),
		        ';',
		        COALESCE(B.EMD, ''),
		        ';',
		        COALESCE(B.RI, ''),
		        ';',
		        COALESCE(B.JIBUN, ''),
		        ';',
		        COALESCE(ST_X(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE(ST_Y(ST_CENTROID(A.SMGEOMETRY)) :: TEXT, ''),
		        ';',
		        COALESCE((SELECT A1 FROM TF_FEIS_LGSTR WHERE 1=1 AND ST_INTERSECTS(SMGEOMETRY, A.SMGEOMETRY) LIMIT 1),'')<!-- pnu -->
		    ) AS RESULT
		FROM
		    TF_FEIS_PCS_SVYCOMPT AS A
		    LEFT JOIN TN_FEIS_PCS_SVYMEMO AS B ON A.GID = B.GID
			,TN_FEIS_PCS_CNRSSPCE C
		WHERE 
			1=1
		AND A.MST_ID = C.ID
		AND A.SMGEOMETRY IS NOT NULL
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
    </select> 
    
    <!--
     @author ipodo
     @param 
     @returns  
     @description 시도 클러스터 
     @ 2023-12-22 : 공간정보테이블 지오메트리 NULL일 경우 AND A.SMGEOMETRY IS NOT NULL 체크를 통해 제외함으로써 일반테이블 개수와 맞지 않는 상황이 발생..
     -->
	<select id="selectClusterSido" resultType="String">
	WITH T AS (
		SELECT A.CTPRVN_COD AS ADMIN_CODE, A.CTPRVN_NM AS ADMIN_NM, ST_ASTEXT(ST_CENTROID(A.SMGEOMETRY)) AS GEOM
		FROM TF_FEIS_CTPRVN A
		GROUP BY ADMIN_CODE,ADMIN_NM,GEOM
		ORDER BY ADMIN_NM
	)
	<![CDATA[
	SELECT CONCAT(T.ADMIN_CODE,';',T.ADMIN_NM,';',T.GEOM,';',COUNT(REGEXP_REPLACE(B.SD,'\s','','g')))
	]]> 
	FROM T,
	<choose>
	<when test="type eq 'bsc'">
	TN_FEIS_BSC_SVYMEMO B
	</when>
	<when test="type eq 'lcp'">
	TN_FEIS_LCP_SVYMEMO B
	</when>
	<when test="type eq 'wka'">
	TN_FEIS_WKA_SVYMEMO01 B
	LEFT JOIN TN_FEIS_WKA_SVYMEMO02 C
	ON B.GID = C.GID 
	LEFT JOIN TN_FEIS_WKA_SVYMEMO03 D
	ON C.GID = D.GID 
	</when>
	<when test="type eq 'cnl'">
	TN_FEIS_CNL_SVYMEMO B
	</when>
	<when test="type eq 'apr'">
	TN_FEIS_FCK_APRMEMO B
	</when>
	<when test="type eq 'frd'">
	TN_FEIS_FRD_SVYMEMO B
	</when>
	<when test="type eq 'mse'">
	TN_FEIS_MSE_SVYMEMO B
	</when>
	<when test="type eq 'pcs'">
	TN_FEIS_PCS_SVYMEMO B
	</when>
	<otherwise>
	
	</otherwise>
	</choose> 
	WHERE
		1=1 
	<![CDATA[
	AND T.ADMIN_NM = REGEXP_REPLACE(B.SD,'\s','','g')
	]]> 
	<choose>
	<when test="type eq 'bsc'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''">
		AND B.SVYUSER = #{user}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>
	</when>
	<when test="type eq 'lcp'">
	<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>			
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY = #{soilty}
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND B.FRSTFRVAL = #{frstfrval}
		</if> 
	</when>
	<when test="type eq 'wka'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="dglog != null and dglog != ''">
		AND C.DGLOGSCORE  = #{dglog}
		</if>
		<if test="direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>   
		<if test="crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="Cldrstnescore != null and Cldrstnescore != ''">
		AND C.CLDRSTNESCORE = #{cldrstnescore}
		</if>   
		<if test="soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
	</when>
	<when test="type eq 'cnl'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
	</when>
	<when test="type eq 'apr'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%',#{orginldamval},'%')  
		</if>
		<if test="orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>
	</when>
	<when test="type eq 'frd'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
	    AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYINSTLLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})	
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYNCSTYLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
	</when>
	<when test="type eq 'mse'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
	</when>
	<when test="type eq 'pcs'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
	</when>
	<otherwise>
			
	</otherwise>
	</choose> 	
	GROUP BY T.ADMIN_CODE, T.ADMIN_NM, T.GEOM
	ORDER BY T.ADMIN_NM 
	</select>    

    <!--
     @author ipodo
     @param 
     @returns  
     @description 시군구 클러스터 
     @ 2023-12-22 : 공간정보테이블 지오메트리 NULL일 경우 AND A.SMGEOMETRY IS NOT NULL 체크를 통해 제외함으로써 일반테이블 개수와 맞지 않는 상황이 발생..
     -->
	<select id="selectClusterSgg" resultType="String">
	WITH T AS (
		SELECT A.SIGNGU_COD AS ADMIN_CODE, CONCAT(REGEXP_REPLACE(A.CTPRVN_NM,'\s','','g'),REGEXP_REPLACE(A.SIGNGU_NM,'\s','','g')) AS ADMIN_NM, ST_ASTEXT(ST_CENTROID(A.SMGEOMETRY)) AS GEOM
		FROM TF_FEIS_SIGNGU A
		GROUP BY ADMIN_CODE,ADMIN_NM,GEOM
		ORDER BY ADMIN_NM
	)
	<![CDATA[
	SELECT CONCAT(T.ADMIN_CODE,';',T.ADMIN_NM,';',T.GEOM,';',COUNT(CONCAT(REGEXP_REPLACE(B.SD,'\s','','g'),REGEXP_REPLACE(B.SGG,'\s','','g'))))
	]]> 
	FROM T,
	<choose>
	<when test="type eq 'bsc'">
	TN_FEIS_BSC_SVYMEMO B
	</when>
	<when test="type eq 'lcp'">
	TN_FEIS_LCP_SVYMEMO B
	</when>
	<when test="type eq 'wka'">
	TN_FEIS_WKA_SVYMEMO01 B
	LEFT JOIN TN_FEIS_WKA_SVYMEMO02 C
	ON B.GID = C.GID 
	LEFT JOIN TN_FEIS_WKA_SVYMEMO03 D
	ON C.GID = D.GID 
	</when>
	<when test="type eq 'cnl'">
	TN_FEIS_CNL_SVYMEMO B
	</when>
	<when test="type eq 'apr'">
	TN_FEIS_FCK_APRMEMO B
	</when>
	<when test="type eq 'frd'">
	TN_FEIS_FRD_SVYMEMO B
	</when>
	<when test="type eq 'mse'">
	TN_FEIS_MSE_SVYMEMO B
	</when>
	<when test="type eq 'pcs'">
	TN_FEIS_PCS_SVYMEMO B
	</when>
	<otherwise>

	</otherwise>
	</choose> 
	WHERE
		1=1 
	<![CDATA[
	AND T.ADMIN_NM = CONCAT(REGEXP_REPLACE(B.SD,'\s','','g'),REGEXP_REPLACE(B.SGG,'\s','','g'))
	]]> 
	<choose>
	<when test="type eq 'bsc'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''">
		AND B.SVYUSER = #{user}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>  	
	</when>
	<when test="type eq 'lcp'">
	<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>			
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY = #{soilty}
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND B.FRSTFRVAL = #{frstfrval}
		</if> 
	</when>
	<when test="type eq 'wka'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="dglog != null and dglog != ''">
		AND C.DGLOGSCORE  = #{dglog}
		</if>
		<if test="direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>   
		<if test="crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="Cldrstnescore != null and Cldrstnescore != ''">
		AND C.CLDRSTNESCORE = #{cldrstnescore}
		</if>   
		<if test="soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
	</when>
	<when test="type eq 'cnl'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
	</when>
	<when test="type eq 'apr'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%',#{orginldamval},'%')  
		</if>
		<if test="orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>
	</when>
	<when test="type eq 'frd'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYINSTLLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYNCSTYLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
	</when>
	<when test="type eq 'mse'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
	</when>
	<when test="type eq 'pcs'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
	</when>
	<otherwise>
			
	</otherwise>
	</choose> 	
	GROUP BY T.ADMIN_CODE, T.ADMIN_NM, T.GEOM
	ORDER BY T.ADMIN_NM 
	</select>    

    <!--
     @author ipodo
     @param 
     @returns  
     @description 읍면동 클러스터 
     @ 2023-12-22 : 공간정보테이블 지오메트리 NULL일 경우 AND A.SMGEOMETRY IS NOT NULL 체크를 통해 제외함으로써 일반테이블 개수와 맞지 않는 상황이 발생..
     -->
	<select id="selectClusterEmd" resultType="String">
	WITH T AS (
		SELECT A.EMD_CODE AS ADMIN_CODE, CONCAT(REGEXP_REPLACE(A.CTPRVN_NM,'\s','','g'),REGEXP_REPLACE(A.SIGNGU_NM,'\s','','g'),REGEXP_REPLACE(A.EMD_NM,'\s','','g')) AS ADMIN_NM, ST_ASTEXT(ST_CENTROID(A.SMGEOMETRY)) AS GEOM
		FROM TF_FEIS_EMD A
		GROUP BY ADMIN_CODE,ADMIN_NM,GEOM
		ORDER BY ADMIN_NM
	)
	<![CDATA[
	SELECT CONCAT(T.ADMIN_CODE,';',T.ADMIN_NM,';',T.GEOM,';',COUNT(CONCAT(REGEXP_REPLACE(B.SD,'\s','','g'),REGEXP_REPLACE(B.SGG,'\s','','g'),REGEXP_REPLACE(B.EMD,'\s','','g'))))
	]]> 
	FROM T,
	<choose>
	<when test="type eq 'bsc'">
	TN_FEIS_BSC_SVYMEMO B
	</when>
	<when test="type eq 'lcp'">
	TN_FEIS_LCP_SVYMEMO B
	</when>
	<when test="type eq 'wka'">
	TN_FEIS_WKA_SVYMEMO01 B
	LEFT JOIN TN_FEIS_WKA_SVYMEMO02 C
	ON B.GID = C.GID 
	LEFT JOIN TN_FEIS_WKA_SVYMEMO03 D
	ON C.GID = D.GID 
	</when>
	<when test="type eq 'cnl'">
	TN_FEIS_CNL_SVYMEMO B
	</when>
	<when test="type eq 'apr'">
	TN_FEIS_FCK_APRMEMO B
	</when>
	<when test="type eq 'frd'">
	TN_FEIS_FRD_SVYMEMO B
	</when>
	<when test="type eq 'mse'">
	TN_FEIS_MSE_SVYMEMO B
	</when>
	<when test="type eq 'pcs'">
	TN_FEIS_PCS_SVYMEMO B
	</when>
	<otherwise>

	</otherwise>
	</choose> 
	WHERE
		1=1 
	<![CDATA[
	AND T.ADMIN_NM = CONCAT(REGEXP_REPLACE(B.SD,'\s','','g'),REGEXP_REPLACE(B.SGG,'\s','','g'),REGEXP_REPLACE(B.EMD,'\s','','g'))
	]]> 
	<choose>
	<when test="type eq 'bsc'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="user != null and user != ''">
		AND B.SVYUSER = #{user}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_BSC_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="svytype.equals('산사태') and safty != null and safty != ''">
		AND B.SAFTYSCORE = #{safty} 
		</if>
		<if test="svytype.equals('토석류') and safty2 != null and safty2 != ''">
		AND B.SAFTYSCORE = #{safty2} 
		</if>
		<if test="svytype.equals('산사태') and slen != null and slen != ''">
		AND B.SLENSCORE = #{slen}
		</if>
		<if test="svytype.equals('산사태') and slope != null and slope != ''">
		AND B.SLOPESCORE = #{slope}
		</if>
		<if test="svytype.equals('산사태') and sform != null and sform != ''">
		AND B.SFORMSCORE = #{sform}
		</if>
		<if test="svytype.equals('산사태') and frstfr != null and frstfr != ''">
		AND B.FRSTFRSCORE = #{frstfr}
		</if>
		<if test="svytype.equals('산사태') and prntrck != null and prntrck != ''">
		AND B.PRNTRCKSCORE = #{prntrck}
		</if>
		<if test="svytype.equals('토석류') and devoccause != null and devoccause != ''">
		AND B.DEVOCCAUSESCORE = #{devoccause}
		</if>
		<if test="svytype.equals('토석류') and trntavgslp != null and trntavgslp != ''">
		AND B.TRNTAVGSLPSCORE = #{trntavgslp}
		</if>
		<if test="svytype.equals('토석류') and wclctarea != null and wclctarea != ''">
		AND B.WCLCTAREASCORE = #{wclctarea}
		</if>
		<if test="svytype.equals('토석류') and tltrntlt != null and tltrntlt != ''">
		AND B.TLTRNTLTSCORE  = #{tltrntlt}
		</if>   	
	</when>
	<when test="type eq 'lcp'">
	<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_LCP_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>			
		<if test="cmprokscore != null and cmprokscore != ''">
		AND B.CMPROKSCORE = #{cmprokscore}
		</if>
		<if test="rokwthrscore != null and rokwthrscore != ''">
		AND B.ROKWTHRSCORE = #{rokwthrscore}
		</if>
		<if test="soilty != null and soilty != ''">
		AND B.SOILTY = #{soilty}
		</if>
		<if test="talusatscore != null and talusatscore != ''">
		AND B.TALUSATSCORE = #{talusatscore}
		</if>
		<if test="tpgrphscore != null and tpgrphscore != ''">
		AND B.TPGRPHSCORE = #{tpgrphscore}
		</if>
		<if test="plnformscore != null and plnformscore != ''">
		AND B.PLNFORMSCORE = #{plnformscore}
		</if>
		<if test="lngformscore != null and lngformscore != ''">
		AND B.LNGFORMSCORE = #{lngformscore}
		</if>
		<if test="slprngscore != null and slprngscore != ''">
		AND B.SLPRNGSCORE = #{slprngscore}
		</if>
		<if test="frstfrval != null and frstfrval != ''">
		AND B.FRSTFRVAL = #{frstfrval}
		</if> 
	</when>
	<when test="type eq 'wka'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_WKA_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="dglog != null and dglog != ''">
		AND C.DGLOGSCORE  = #{dglog}
		</if>
		<if test="direffcsafe != null and direffcsafe != ''">
		AND C.DIREFFCSCORE = #{direffcsafe}
		</if>   
		<if test="crcksittn != null and crcksittn != ''">
		AND C.CRCKSITTNSCORE = #{crcksittn}
		</if>   
		<if test="clps != null and clps != ''">
		AND C.CLPSSCORE = #{clps}
		</if>   
		<if test="surfacedir != null and surfacedir != ''">
		AND C.SURFACESCORE = #{surfacedir}
		</if>   
		<if test="wtrsttus != null and wtrsttus != ''">
		AND C.WTRSTTUSSCORE  = #{wtrsttus}
		</if>   
		<if test="lndslddgscore != null and lndslddgscore != ''">
		AND C.LNDSLDDGSCORE = #{lndslddgscore}
		</if>   
		<if test="watersttus != null and watersttus != ''">
		AND C.WATERSTTUSSCORE  = #{watersttus}
		</if>   
		<if test="clpsscore != null and clpsscore != ''">
		AND C.CLPSSCORE = #{clpsscore}
		</if>   
		<if test="corrosionscore != null and corrosionscore != ''">
		AND C.CORROSIONSCORE = #{corrosionscore}
		</if>   
		<if test="Cldrstnescore != null and Cldrstnescore != ''">
		AND C.CLDRSTNESCORE = #{cldrstnescore}
		</if>   
		<if test="soiltracescore != null and soiltracescore != ''">
		AND C.SOILTRACESCORE = #{soiltracescore}
		</if>   
		<if test="foreststtusscore != null and foreststtusscore != ''">
		AND C.FORESTSTTUSSCORE = #{foreststtusscore}
		</if>   
		<if test="rootcharscore != null and rootcharscore != ''">
		AND C.ROOTCHARSCORE = #{rootcharscore}
		</if>
	</when>
	<when test="type eq 'cnl'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE LIKE CONCAT('%',#{svytype},'%')
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_CNL_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="svytype.equals('산사태') and biztype != null and biztype != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('산사태') and applcegnermhd != null and applcegnermhd != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd},'%') 
		</if>
		<if test="svytype.equals('산사태') and dsstroccrrncat != null and dsstroccrrncat != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat}
		</if>
		<if test="svytype.equals('토석류') and biztype2 != null and biztype2 != ''">
		AND B.BIZTYPE LIKE '%' || SUBSTRING(#{biztype2} FROM 1 for 4) || '%'
		</if>
		<if test="svytype.equals('토석류') and applcegnermhd2 != null and applcegnermhd2 != ''">
		AND B.APPLCEGNERMHDLIKE CONCAT('%',#{applcegnermhd2},'%') 
		</if>
		<if test="svytype.equals('토석류') and dsstroccrrncat2 != null and dsstroccrrncat2 != ''">
		AND B.DSSTROCCRRNCAT = #{dsstroccrrncat2}
		</if>
		<if test="svytype.equals('산사태') and ssttus != null and ssttus != ''">
		AND B.SSTTUS = #{ssttus}
		</if>
		<if test="svytype.equals('산사태') and stableintrprtscore != null and stableintrprtscore != ''">
		AND B.STABLEINTRPRTSCORE = #{stableintrprtscore}
		</if>
		<if test="svytype.equals('토석류') and mrngsttus != null and mrngsttus != ''">
		AND B.MRNGSTTUS = #{mrngsttus}
		</if>
		<if test="svytype.equals('토석류') and simlatnrsltyn != null and simlatnrsltyn != ''">
		AND B.SIMLATNRSLTYN = #{simlatnrsltyn}
		</if>
		<if test="svytype.equals('토석류') and reducat != null and reducat != ''">
		AND B.REDUCAT = #{reducat}
		</if>
	</when>
	<when test="type eq 'apr'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_APR_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="orginldamval != null and orginldamval != ''">	
		AND B.ORGINLDAMVAL LIKE CONCAT('%', #{orginldamval},'%')  
		</if>
		<if test="orginldamjdgval != null and orginldamjdgval != ''">	
		AND B.ORGINLDAMJDGVAL = #{orginldamjdgval}
		</if>
		<if test="sidewallval != null and sidewallval != ''">	
		AND B.SIDEWALLVAL LIKE CONCAT('%',#{sidewallval},'%')
		</if>
		<if test="sidewalljdgval != null and sidewalljdgval != ''">	
		AND B.SIDEWALLJDGVAL = #{sidewalljdgval}  
		</if>
		<if test="dwnsptval != null and dwnsptval != ''">	
		AND B.DWNSPTVAL LIKE CONCAT('%',#{dwnsptval},'%') 
		</if>
		<if test="dwnsptjdgval != null and dwnsptjdgval != ''">
		AND B.DWNSPTJDGVAL = #{dwnsptjdgval}  
		</if>
		<if test="reinfcval != null and reinfcval != ''">	
		AND B.REINFCVAL LIKE CONCAT('%',#{reinfcval},'%') 
		</if>
		<if test="reinfcjdgval != null and reinfcjdgval != ''">	
		AND B.REINFCJDGVAL = #{reinfcjdgval}  
		</if>
		<if test="prtcval != null and prtcval != ''">	
		AND B.PRTCVAL LIKE CONCAT('%',#{prtcval},'%')
		</if>
		<if test="prtcjdgval != null and prtcjdgval != ''">	
		AND B.PRTCJDGVAL = #{prtcjdgval}  
		</if>
		<if test="drngval != null and drngval != ''">	
		AND B.DRNGVAL  LIKE CONCAT('%',#{drngval},'%')
		</if>
		<if test="drngjdgval != null and drngjdgval != ''">	
		AND B.DRNGJDGVAL = #{drngjdgval}  
		</if>
		<if test="chkdamval != null and chkdamval != ''">	
		AND B.CHKDAMVAL LIKE CONCAT('%',#{chkdamval},'%') 
		</if>
		<if test="chkdamjdgval != null and chkdamjdgval != ''">	
		AND B.CHKDAMJDGVAL = #{chkdamjdgval}  
		</if>
		<if test="rvtmntval != null and rvtmntval != ''">	
		AND B.RVTMNTVAL LIKE CONCAT('%',#{rvtmntval}  ,'%')
		</if>
		<if test="rvtmntjdgval != null and rvtmntjdgval != ''">	
		AND B.RVTMNTJDGVAL = #{rvtmntjdgval}  
		</if>
		<if test="grdstabl != null and grdstabl != ''">	
		AND B.GRDSTABLVAL LIKE CONCAT('%',#{grdstabl},'%')
		</if>
		<if test="grdstabljdgval != null and grdstabljdgval != ''">	
		AND B.GRDSTABLJDGVAL = #{grdstabljdgval}  
		</if>
	</when>
	<when test="type eq 'frd'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="frdtype != null and frdtype != ''">
		AND B.FRDTYPE = #{frdtype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_FRD_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="safefct != null and safefct != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.SAFEFCTLIST::JSONB) AS ELEM WHERE ELEM->>'유형' = #{safefct})
		</if>
		<if test="field != null and field != ''">
		AND B.FIELD = #{field}
		</if>
		<if test="acsbl != null and acsbl != ''">
		AND B.ACSBL = #{acsbl}
		</if>
		<if test="lonslopeavg != null and lonslopeavg != ''">
		AND B.LONSLOPEAVG = #{lonslopeavg}
		</if>
		<if test="mtslopeavg != null and mtslopeavg != ''">
		AND B.MTSLOPEAVG = #{mtslopeavg}
		</if>
		<if test="afrstat != null and afrstat != ''">
		AND B.AFRSTAT = #{afrstat}
		</if>
		<if test="cuttingat != null and cuttingat != ''">
		AND B.CUTTINGAT = #{cuttingat}
		</if>
		<if test="stonyland != null and stonyland != ''">
		<if test="stonyland.equals('유')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) > 0
		</if>
		<if test="stonyland.equals('무')">
		AND JSON_ARRAY_LENGTH(COALESCE(B.STMILIST,'[]')::JSON) = 0
		</if>
		</if>
		<if test="wetlandat != null and wetlandat != ''">
		AND B.WETLANDAT = #{wetlandat}
		</if>
		<if test="cmtryat != null and cmtryat != ''">
			<if test="cmtryat.equals('유')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) > 0
			</if>
			<if test="cmtryat.equals('무')">
			AND JSON_ARRAY_LENGTH(COALESCE(B.CMTRYLIST,'[]')::JSON) = 0
			</if>
		</if>
		<if test="eltnwaterat != null and eltnwaterat != ''">
		AND B.ELTNWATERAT = #{eltnwaterat}
		</if>
		<if test="sofrtgrndat != null and sofrtgrndat != ''">
		AND B.SOFRTGRNDAT = #{sofrtgrndat}
		</if>
		<if test="maintreekndcnt != null and maintreekndcnt != ''">
<!-- 		AND B.MAINTREEKNDCNT = #{maintreekndcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINTREEKNDLIST::JSONB) AS ELEM WHERE ELEM->>'주요수종' = #{maintreekndcnt})
		</if>
		<if test="mainvegcnt != null and mainvegcnt != ''">
<!-- 		AND B.MAINVEGCNT = #{mainvegcnt} -->
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.MAINVEGLIST::JSONB) AS ELEM WHERE ELEM->>'주요식생' = #{mainvegcnt})
		</if>
		<if test="wtrpltnat != null and wtrpltnat != ''">
		AND B.WTRPLTNAT = #{wtrpltnat}
		</if>
		<if test="dmgcncrnat != null and dmgcncrnat != ''">
		AND B.DMGCNCRNAT = #{dmgcncrnat}
		</if>
		<if test="frstdsstrcnt != null and frstdsstrcnt != ''">
		AND B.FRSTDSSTRCNT = #{frstdsstrcnt}
		</if>
		<if test="wildanmlcnt != null and wildanmlcnt != ''">
		AND B.WILDANMLKIND LIKE CONCAT ('%',#{wildanmlcnt},'%')
		</if>
		<if test="ecnrfcltyinstlcnt != null and ecnrfcltyinstlcnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYINSTLLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설설치_유형' = #{ecnrfcltyinstlcnt})
		</if>
		<if test="ecnrfcltyncstycnt != null and ecnrfcltyncstycnt != ''">
		AND EXISTS (SELECT 1 FROM JSONB_ARRAY_ELEMENTS(B.ECNRFCLTYNCSTYLIST::JSONB) AS ELEM WHERE ELEM->>'사방시설필요_유형' = #{ecnrfcltyncstycnt})
		</if>
	</when>
	<when test="type eq 'mse'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="eqpmntype != null and eqpmntype != ''">
		AND B.EQPMNTYPE = #{eqpmntype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_MSE_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>		
		<if test="wireextlock != null and wireextlock != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'자물쇠' = #{wireextlock}
		</if>
		<if test="wireextwire != null and wireextwire != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'와이어' = #{wireextwire}
		</if>
		<if test="wireextcable != null and wireextcable != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'케이블' = #{wireextcable}
		</if>
		<if test="wireextpower != null and wireextpower != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'전원' = #{wireextpower}
		</if>
		<if test="wireextprotect != null and wireextprotect != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'보호함체' = #{wireextprotect}
		</if>
		<if test="wireextcensor != null and wireextcensor != ''">
		AND B.WIREEXT::JSONB->'외관점검'->>'센서부' = #{wireextcensor}
		</if>
		<if test="wireextchkrst != null and wireextchkrst != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'점검결과' = #{wireextchkrst}
		</if>
		<if test="wireextsyscsrval != null and wireextsyscsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'시스템센서값' = #{wireextsyscsrval}
		</if>
		<if test="wireextsitecsrval != null and wireextsitecsrval != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'현장센서값' = #{wireextsitecsrval}
		</if>
		<if test="wireextbadstat != null and wireextbadstat != ''">
		AND B.WIREEXT::JSONB->'성능점검'->>'불량상태' = #{wireextbadstat}
		</if>
		<if test="licmeterlock != null and licmeterlock != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'자물쇠' = #{licmeterlock}
		</if>
		<if test="licmetercable != null and licmetercable != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'케이블' = #{licmetercable}
		</if>
		<if test="licmeterprotect != null and licmeterprotect != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'보호함체' = #{licmeterprotect}
		</if>
		<if test="licmeterpower != null and licmeterpower != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'전원' = #{licmeterpower}
		</if>
		<if test="licmetercensor != null and licmetercensor != ''">
		AND B.LICMETER::JSONB->'외관점검'->>'센서부' = #{licmetercensor}
		</if>
		<if test="gwgaugelock != null and gwgaugelock != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'자물쇠' = #{gwgaugelock}
		</if>
		<if test="gwgaugecable != null and gwgaugecable != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'케이블' = #{gwgaugecable}
		</if>
		<if test="gwgaugeprotect != null and gwgaugeprotect != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'보호함체' = #{gwgaugeprotect}
		</if>
		<if test="gwgaugepower != null and gwgaugepower != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'전원' = #{gwgaugepower}
		</if>
		<if test="gwgaugecensor != null and gwgaugecensor != ''">
		AND B.GWGAUGE::JSONB->'외관점검'->>'센서부' = #{gwgaugecensor}
		</if>
		<if test="gwgaugechkrst != null and gwgaugechkrst != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'점검결과' = #{gwgaugechkrst}
		</if>
		<if test="gwgaugesitecsrval1 != null and gwgaugesitecsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값1' = #{gwgaugesitecsrval1}
		</if>
		<if test="gwgaugesitecsrval12 != null and gwgaugesitecsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'현장센서값2' = #{gwgaugesitecsrval2}
		</if>
		<if test="gwgaugesyscsrval1 != null and gwgaugesyscsrval1 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값1' = #{gwgaugesyscsrval1}
		</if>
		<if test="gwgaugesyscsrval2 != null and gwgaugesyscsrval2 != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'시스템센서값2' = #{gwgaugesyscsrval2}
		</if>
		<if test="gwgaugebadstat != null and gwgaugebadstat != ''">
		AND B.GWGAUGE::JSONB->'성능점검'->>'불량상태' = #{gwgaugebadstat}
		</if>
		<if test="raingaugecable != null and raingaugecable != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'케이블' = #{raingaugecable}
		</if>
		<if test="raingaugeprotect != null and raingaugeprotect != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'보호함체' = #{raingaugeprotect}
		</if>
		<if test="raingaugepower != null and raingaugepower != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'전원' = #{raingaugepower}
		</if>
		<if test="raingaugecensor != null and raingaugecensor != ''">
		AND B.RAINGAUGE::JSONB->'외관점검'->>'센서부' = #{raingaugecensor}
		</if>
		<if test="raingaugechkrst != null and raingaugechkrst != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'점검결과' = #{raingaugechkrst}
		</if>
		<if test="raingaugevoltage != null and raingaugevoltage != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'전압' = #{raingaugevoltage}
		</if>
		<if test="raingaugebadstat != null and raingaugebadstat != ''">
		AND B.RAINGAUGE::JSONB->'성능점검'->>'불량상태' = #{raingaugebadstat}
		</if>
		<if test="surdpmcable != null and surdpmcable != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'케이블' = #{surdpmcable}
		</if>
		<if test="surdpmpower != null and surdpmpower != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'전원' = #{surdpmpower}
		</if>
		<if test="surdpmcensor != null and surdpmcensor != ''">
		AND B.SURDPM::JSONB->'외관점검'->>'센서부' = #{surdpmcensor}
		</if>
		<if test="surdpmchkrst != null and surdpmchkrst != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'점검결과' = #{surdpmchkrst}
		</if>
		<if test="surdpmsitecsrvalx != null and surdpmsitecsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_X' = #{surdpmsitecsrvalx}
		</if>
		<if test="surdpmsitecsrvaly != null and surdpmsitecsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_Y' = #{surdpmsitecsrvaly}
		</if>
		<if test="surdpmsitecsrvalacc != null and surdpmsitecsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'현장센서값_가속도' = #{surdpmsitecsrvalacc}
		</if>
		<if test="surdpmsyscsrvalx != null and surdpmsyscsrvalx != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_X' = #{surdpmsyscsrvalx}
		</if>
		<if test="surdpmsyscsrvaly != null and surdpmsyscsrvaly != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_Y' = #{surdpmsyscsrvaly}
		</if>
		<if test="surdpmsyscsrvalacc != null and surdpmsyscsrvalacc != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'시스템센서값_가속도' = #{surdpmsyscsrvalacc}
		</if>
		<if test="surdpmbadstat != null and surdpmbadstat != ''">
		AND B.SURDPM::JSONB->'성능점검'->>'불량상태' = #{surdpmbadstat}
		</if>
		<if test="gpsgaugecable != null and gpsgaugecable != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'케이블' = #{gpsgaugecable}
		</if>
		<if test="gpsgaugepower != null and gpsgaugepower != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'전원' = #{gpsgaugepower}
		</if>
		<if test="gpsgaugecensor != null and gpsgaugecensor != ''">
		AND B.GPSGAUGE::JSONB->'외관점검'->>'센서부' = #{gpsgaugecensor}
		</if>
		<if test="gpsgaugechkrst != null and gpsgaugechkrst != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'점검결과' = #{gpsgaugechkrst}
		</if>
		<if test="gpsgaugebadstat != null and gpsgaugebadstat != ''">
		AND B.GPSGAUGE::JSONB->'성능점검'->>'불량상태' = #{gpsgaugebadstat}
		</if>
		<if test="gatewaylock != null and gatewaylock != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'자물쇠' = #{gatewaylock}
		</if>
		<if test="gatewaysunlight != null and gatewaysunlight != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'태양광' = #{gatewaysunlight}
		</if>
		<if test="gatewayconsole != null and gatewayconsole != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'함체' = #{gatewayconsole}
		</if>
		<if test="gatewaybranchline != null and gatewaybranchline != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'지선' = #{gatewaybranchline}
		</if>
		<if test="gatewayprotect != null and gatewayprotect != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'보호휀스' = #{gatewayprotect}
		</if>
		<if test="gatewayinfoboard != null and gatewayinfoboard != ''">
		AND B.GATEWAY::JSONB->'외관점검'->>'안내판' = #{gatewayinfoboard}
		</if>
		<if test="gatewaychkrst != null and gatewaychkrst != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'점검결과' = #{gatewaychkrst}
		</if>
		<if test="gatewaygoodvoltage != null and gatewaygoodvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'양호전압' = #{gatewaygoodvoltage}
		</if>
		<if test="gatewaychkvoltage != null and gatewaychkvoltage != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'측정전압' = #{gatewaychkvoltage}
		</if>
		<if test="gatewaybadstat != null and gatewaybadstat != ''">
		AND B.GATEWAY::JSONB->'성능점검'->>'불량상태' = #{gatewaybadstat}
		</if>
		<if test="nodelock != null and nodelock != ''">
		AND B.NODE::JSONB->'외관점검'->>'자물쇠' = #{nodelock}
		</if>
		<if test="nodesunlight != null and nodesunlight != ''">
		AND B.NODE::JSONB->'외관점검'->>'태양광' = #{nodesunlight}
		</if>
		<if test="nodeconsole != null and nodeconsole != ''">
		AND B.NODE::JSONB->'외관점검'->>'함체' = #{nodeconsole}
		</if>
		<if test="nodebranchline != null and nodebranchline != ''">
		AND B.NODE::JSONB->'외관점검'->>'지선' = #{nodebranchline}
		</if>
		<if test="nodeprotect != null and nodeprotect != ''">
		AND B.NODE::JSONB->'외관점검'->>'보호휀스' = #{nodeprotect}
		</if>
		<if test="nodeinfoboard != null and nodeinfoboard != ''">
		AND B.NODE::JSONB->'외관점검'->>'안내판' = #{nodeinfoboard}
		</if>
		<if test="nodegoodvoltage1 != null and nodegoodvoltage1 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압1' = #{nodegoodvoltage1}
		</if>
		<if test="nodegoodvoltage2 != null and nodegoodvoltage2 != ''">
		AND B.NODE::JSONB->'성능점검'->>'양호전압2' = #{nodegoodvoltage2}
		</if>
		<if test="nodechk != null and nodechk != ''">
		AND B.NODE::JSONB->'성능점검'->>'측정' = #{nodechk}
		</if>
		<if test="nodebadstat != null and nodebadstat != ''">
		AND B.NODE::JSONB->'성능점검'->>'불량상태' = #{nodebadstat}
		</if>
	</when>
	<when test="type eq 'pcs'">
		<if test="startdt != null and startdt != '' and enddt != null and enddt != ''">
		<![CDATA[
		AND (TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') >= TO_DATE(#{startdt}, 'YYYY-MM-DD') AND TO_DATE(TO_CHAR(B.CREAT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(#{enddt}, 'YYYY-MM-DD'))
		]]>
		</if>
		<if test="svytype != null and svytype != ''">
		AND B.SVYTYPE = #{svytype}
		</if>
		<if test="sd != null and sd != ''">
		AND B.SD = (SELECT CTPRVN_NM FROM TF_FEIS_CTPRVN WHERE CTPRVN_COD = #{sd})	
		</if>		
		<if test="sgg != null and sgg != ''">
		AND B.SGG = (SELECT SIGNGU_NM FROM TF_FEIS_SIGNGU WHERE SIGNGU_COD = #{sgg})
		</if>
		<if test="emd != null and emd != ''">
		AND B.EMD = (SELECT EMD_NM FROM TF_FEIS_EMD WHERE EMD_CODE = #{emd})
		</if>
		<if test="ri != null and ri != ''">
		AND B.RI = (SELECT LI_NM FROM TF_FEIS_LI WHERE LI_CODE = #{ri}) 
		</if>
		<if test="jibun != null and jibun != ''">	
		AND B.JIBUN = #{jibun}  
		</if>
		<if test="svyuser != null and svyuser != ''">
		AND B.SVYUSER = #{svyuser}
		</if>		
		<if test="id != null and id != ''">
		AND B.SVYID = #{id}
		</if>		
		<if test="mstnm != null and mstnm != ''">
		AND B.MSTID IN (SELECT ID FROM TN_FEIS_PCS_CNRSSPCE WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%'))
		</if>
		<if test="ecnrknd != null and ecnrknd != ''">	
		AND B.ECNRKND = #{ecnrknd}  
		</if>
		<if test="svyform != null and svyform != ''">	
		AND B.SVYFORM = #{svyform}  
		</if>
		<if test="fctyear != null and fctyear != ''">	
		AND B.FCTYEAR = #{fctyear}  
		</if>
		<if test="ecnrrnum != null and ecnrrnum != ''">	
		AND B.ECNRRNUM LIKE CONCAT(#{ecnrrnum},'%')  
		</if>
		<if test="nationspotnum != null and nationspotnum != ''">	
		AND B.NATIONSPOTNUM LIKE CONCAT(#{nationspotnum},'%')
		</if>
		<if test="orginldamdmg != null and orginldamdmg != ''">	
		AND B.ORGINLDAMDMG = #{orginldamdmg}  
		</if>
		<if test="orginldamcrk != null and orginldamcrk != ''">	
		AND B.ORGINLDAMCRK = #{orginldamcrk}  
		</if>
		<if test="orginldambasicscour != null and orginldambasicscour != ''">	
		AND B.ORGINLDAMBASICSCOUR = #{orginldambasicscour}  
		</if>
		<if test="orginldamwtgate != null and orginldamwtgate != ''">	
		AND B.ORGINLDAMWTGATE = #{orginldamwtgate}  
		</if>
		<if test="sidewalldmg != null and sidewalldmg != ''">	
		AND B.SIDEWALLDMG = #{sidewalldmg}  
		</if>
		<if test="sidewallcrk != null and sidewallcrk != ''">	
		AND B.SIDEWALLCRK = #{sidewallcrk}  
		</if>
		<if test="sidewallbasicscour != null and sidewallbasicscour != ''">	
		AND B.SIDEWALLBASICSCOUR = #{sidewallbasicscour}  
		</if>
		<if test="dwnsptdmg != null and dwnsptdmg != ''">	
		AND B.DWNSPTDMG = #{dwnsptdmg}  
		</if>
		<if test="dwnsptbasicscour != null and dwnsptbasicscour != ''">	
		AND B.DWNSPTBASICSCOUR = #{dwnsptbasicscour}  
		</if>
		<if test="dwnsptcrk != null and dwnsptcrk != ''">	
		AND B.DWNSPTCRK = #{dwnsptcrk}  
		</if>
		<if test="svycrctn != null and svycrctn != ''">	
		AND B.SVYCRCTN = #{svycrctn}  
		</if>
		<if test="cncrtcmprsstrn != null and cncrtcmprsstrn != ''">	
		AND B.CNCRTCMPRSSTRN = #{cncrtcmprsstrn}  
		</if>
		<if test="cncrtcrkdpt != null and cncrtcrkdpt != ''">	
		AND B.CNCRTCRKDPT = #{cncrtcrkdpt}  
		</if>
		<if test="nowsnddpsitvaldivision != null and nowsnddpsitvaldivision != ''">	
		AND B.NOWSNDDPSITVALDIVISION = #{nowsnddpsitvaldivision}  
		</if>
		<if test="lifezonedivision != null and lifezonedivision != ''">	
		AND B.LIFEZONEDIVISION = #{lifezonedivision}  
		</if>
		<if test="riverbedgradientdivision != null and riverbedgradientdivision != ''">	
		AND B.RIVERBEDGRADIENTDIVISION = #{riverbedgradientdivision}  
		</if>
		<if test="soilmoveamntdivision != null and soilmoveamntdivision != ''">	
		AND B.SOILMOVEAMNTDIVISION = #{soilmoveamntdivision}  
		</if>
		<if test="drdgnatjdg != null and drdgnatjdg != ''">	
		AND B.DRDGNATJDG = #{drdgnatjdg}
		</if>
	</when>
	<otherwise>
			
	</otherwise>
	</choose> 	
	GROUP BY T.ADMIN_CODE, T.ADMIN_NM, T.GEOM
	ORDER BY T.ADMIN_NM 
	</select>
	
	<!-- 공유방명 검색 -->
	<select id="selectSvyComptMstIdLst" parameterType="hashMap" resultType="String">
		SELECT ARRAY_TO_STRING(ARRAY_AGG(ID),',') AS IDS
		FROM
		<if test="type.equals('bsc')">TN_FEIS_BSC_CNRSSPCE</if>
		<if test="type.equals('apr')">TN_FEIS_APR_CNRSSPCE</if>
		<if test="type.equals('lcp')">TN_FEIS_LCP_CNRSSPCE</if>
		<if test="type.equals('wka')">TN_FEIS_WKA_CNRSSPCE</if>
		<if test="type.equals('cnl')">TN_FEIS_CNL_CNRSSPCE</if>
		<if test="type.equals('frd')">TN_FEIS_FRD_CNRSSPCE</if>
		<if test="type.equals('pcs')">TN_FEIS_PCS_CNRSSPCE</if>
		<if test="type.equals('mse')">TN_FEIS_MSE_CNRSSPCE</if>
		WHERE MST_PARTNAME LIKE CONCAT('%',#{mstnm},'%')
	</select>
</mapper>